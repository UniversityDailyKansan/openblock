{% extends "base.html" %}{% comment %} -*- mode: django-html; tab-width: 4 -*- {% endcomment %}
{% load django_static eb humanize mapping %}

{% block fulltitle %}Map of {% METRO_NAME %}{% endblock %}

{% block content %}
<style type="text/css">
h2 { float:left; }
</style>
	<div class="row">
				<div class="six col">
					<h2 class="gray">Filter your sources by <span class="green">clicking the plus sign</span> on the right</h2>
				</div>
				<div class="six col">
					<h2 class="gray show-on-phones">Use the <span class="green">plus and minus buttons</span> on the left to zoom instead of pinching the map. It's ticklish.</h2>
				</div>
	</div>
<div class="row">
		<div id="mapwrapper" class="fullpage eight col" style="border:none">
		  <script type="text/javascript">
	    {% autoescape off %}
      function loadMap() {
          var config = {{map_config}};
          config['baselayer_type']  = "{{ MAP_BASELAYER_TYPE }}";

          var map = new OBMap(config);
          map.map.addControl(new OpenLayers.Control.LayerSwitcher());
          
          var permalink = new OpenblockPermalink(map);
          map.map.addControl(permalink);

          var dateControl = new OBMapDateRange(map, permalink, '#map_date_range_form');

          var headlines = new OBMapItemList(map, {'element': '#map_headlines'});
          $('#mapwrapper').css('margin-left', $('#map_headlines').css('width'));
          
          return map;
      }
      {% endautoescape %}
		  </script>
		{% include "richmaps/richmap.html" %}
		</div><!-- end mapwrapper -->
		<div class="row">
    <div id="map_date_range">
        <form action="#" id="map_date_range_form" class="nice">
        	<div class="six col">
        		Start Date: <input type="text" class="begin-date" id="map_begin_date" style="width:125px"/>
        	</div>
        	<div class="six col">
			<input type="text" class="end-date" id="map_end_date" style="width:125px"/>
    		    <button type="submit" value="change" style="display:inline">Change</button>
    		   </div>
  		  </form>
  		 </div>
  		</div>
    </div>
    <div id="map_headlines" class="map-headlines four col"></div>
{% endblock %}
